SELECT PI.CODPRODUTO,  SUM(PI.quantpedida / PRO.UNIDADEESTOQUE) as quant,  (case when P.DATAENTREGA > 25.09.2013   THEN CAST(P.DATAENTREGA AS DATE) - CAST(25.09.2013 AS DATE) ELSE 0 END)    AS DIASPARAENTREGA,   (case when P.situacao = '0' THEN 'P' ELSE 'C' END) AS SIT  FROM PEDIDO P  INNER JOIN PEDIDOIT PI ON PI.codpedido = P.codpedido  INNER JOIN PRODUTO PRO ON PRO.CODPRODUTO = PI.CODPRODUTO  where P.situacao IN ('0', '1', '2') AND  P.dataentrega BETWEEN (25.09.2013-30 AND (25.09.2013 + CAST( 1 AS INTEGER)  GROUP BY PI.CODPRODUTO, DIASPARAENTREGA, SIT  order by pi.CODPRODUTO, SIT, DIASPARAENTREGA 
